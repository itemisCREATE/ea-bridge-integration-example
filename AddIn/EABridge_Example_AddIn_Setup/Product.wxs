<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Id="*" Name="EA - YAKINDU EA-Bridge Integration Example AddIn" Language="1033" Version="1.0.0.0" Manufacturer="itemis AG" UpgradeCode="A3AEAA62-10B3-482A-BB69-BE186C4BAE59">
		<Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />

		<Media Id="1" Cabinet="EABridgeAddIn.cab" EmbedCab="yes" />

		<!-- Prerequisites -->
		<PropertyRef Id="NETFRAMEWORK45"/>
		<Condition Message="This setup requires the .NET Framework 4.5 to be installed.">
			Installed OR NETFRAMEWORK45
		</Condition>

		<!-- Upgrade: Remove previous installer -->
		<Property Id='PREVIOUSVERSIONSINSTALLED' Secure='yes' />
		<Upgrade Id='A3AEAA62-10B3-482A-BB69-BE186C4BAE59'>
			<UpgradeVersion Minimum='1.0.0.0'
							Maximum='99.0.0.0'
							Property='PREVIOUSVERSIONSINSTALLED'
							IncludeMinimum='yes'
							IncludeMaximum='no' />
		</Upgrade>

		<!-- Custom actions, see https://www.firegiant.com/wix/tutorial/events-and-actions/at-a-later-stage/) -->
		<!-- The features -->
		<Feature Id="EABridgeAddinFeature" Title="EA - YAKINDU EA-Bridge Integration" Level="1" AllowAdvertise="no">
			<!-- The component groups are located in *.generated.wxs files, which were automatically generated by heap (see pre build events of project) -->
			<ComponentGroupRef Id="EABridgeAddInGroup"/>
			<ComponentGroupRef Id="DependencyDllComponentGroup"/>
			<ComponentRef Id="EABridgeExampleCLISoftwareAssistantDllEARegistryKeyComponent" />
		</Feature>

		    <InstallExecuteSequence>
      <RemoveExistingProducts Before="InstallInitialize" />
    </InstallExecuteSequence>

		<!-- User Interface (UI) -->
		<?include Dialog.wxi ?>
	</Product>

	<!-- The Components to be installed -->
	<Fragment>
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFilesFolder">
				<Directory Id="CompanyFolder" Name="itemis AG">
					<Directory Id="INSTALLFOLDER" Name="EA Add-in">
						<!-- Registry Keys: EA Add-in -->
						<Component Id="EABridgeExampleCLISoftwareAssistantDllEARegistryKeyComponent" KeyPath="no" Guid="00C5323F-86A5-4B66-B5AA-0B272B3F0297">
							<RegistryKey Root="HKLM" Key="SOFTWARE\Sparx Systems\EAAddins\YAKINDU EA-Bridge Integration Add-in" ForceDeleteOnUninstall="yes">
								<RegistryValue Value="EABridge_Example_AddIn.ExampleValidationAddIn" Type="string" />
							</RegistryKey>
						</Component>
					</Directory>
				</Directory>
			</Directory>
		</Directory>
	</Fragment>
</Wix>
