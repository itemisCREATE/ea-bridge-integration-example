<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
	<Package Name="EA - Itemis INTEGRATE-EA Example AddIn" Language="1033" Version="1.0.0.0" Manufacturer="itemis AG" UpgradeCode="A3AEAA62-10B3-482A-BB69-BE186C4BAE59" InstallerVersion="200">
		

		<Media Id="1" Cabinet="ItemisIntegrateEAAddIn.cab" EmbedCab="yes" />

		<!-- Prerequisites -->
		<PropertyRef Id="NETFRAMEWORK45" />
		<Launch Condition="Installed OR NETFRAMEWORK45" Message="This setup requires the .NET Framework 4.5 to be installed." />

		<!-- Upgrade: Remove previous installer -->
		<Property Id="PREVIOUSVERSIONSINSTALLED" Secure="yes" />
		<Upgrade Id="A3AEAA62-10B3-482A-BB69-BE186C4BAE59">
			<UpgradeVersion Minimum="1.0.0.0" Maximum="99.0.0.0" Property="PREVIOUSVERSIONSINSTALLED" IncludeMinimum="yes" IncludeMaximum="no" />
		</Upgrade>

		<!-- Custom actions, see https://www.firegiant.com/wix/tutorial/events-and-actions/at-a-later-stage/) -->
		<!-- The features -->
		<Feature Id="ItemisIntegrateEAAddinFeature" Title="EA - Itemis INTEGRATE-EA" Level="1" AllowAdvertise="no">
			<!-- The component groups are located in *.generated.wxs files, which were automatically generated by heap (see pre build events of project) -->
			<ComponentGroupRef Id="ItemisIntegrateEAAddInGroup" />
			<ComponentGroupRef Id="DependencyDllComponentGroup" />
			<ComponentRef Id="ItemisIntegrateEAExampleCLISoftwareAssistantDllEARegistryKeyComponent" />
		</Feature>

		    <InstallExecuteSequence>
      <RemoveExistingProducts Before="InstallInitialize" />
    </InstallExecuteSequence>

		<!-- User Interface (UI) -->
		<?include Dialog.wxi ?>
	</Package>

	<!-- The Components to be installed -->
	<Fragment>
			<StandardDirectory Id="ProgramFilesFolder">
				<Directory Id="CompanyFolder" Name="itemis AG">
					<Directory Id="INSTALLFOLDER" Name="EA Add-in">
						<!-- Registry Keys: EA Add-in -->
						<Component Id="ItemisIntegrateEAExampleCLISoftwareAssistantDllEARegistryKeyComponent" KeyPath="no" Guid="00C5323F-86A5-4B66-B5AA-0B272B3F0297">
							<RegistryKey Root="HKLM" Key="SOFTWARE\Sparx Systems\EAAddins\Itemis INTEGRATE-EA Add-in" ForceDeleteOnUninstall="yes">
								<RegistryValue Value="Itemis_Integrate_EA_Example_AddIn.ExampleValidationAddIn" Type="string" />
							</RegistryKey>
						</Component>
					</Directory>
				</Directory>
			</StandardDirectory>
		</Fragment>
</Wix>
